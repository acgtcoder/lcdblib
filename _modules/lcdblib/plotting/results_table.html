<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../../../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../../../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../../../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>lcdblib.plotting.results_table &#8212; lcdblib 0.1.2.post.dev37 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1.2.post.dev37',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  
   

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">lcdblib 0.1.2.post.dev37 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
        <a href="
    ../../../index.html" class="text-logo">lcdblib 0.1.2.post.dev37 documentation</a>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">lcdblib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autodocs/modules.html">lcdblib</a></li>
</ul>

    
  </div>
</div>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../../../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../../../index.html">Docs</a></li>
              
                <li><a href="../../index.html">Module code</a></li>
              
              <li>lcdblib.plotting.results_table</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <h1>Source code for lcdblib.plotting.results_table</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">textwrap</span> <span class="k">import</span> <span class="n">dedent</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="k">import</span> <span class="n">blended_transform_factory</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">MaxNLocator</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="k">import</span> <span class="n">EventCollection</span>
<span class="kn">import</span> <span class="nn">gffutils</span>
<span class="kn">import</span> <span class="nn">pybedtools</span>
<span class="kn">from</span> <span class="nn">pybedtools</span> <span class="k">import</span> <span class="n">featurefuncs</span>

<span class="kn">from</span> <span class="nn">..</span> <span class="n">utils</span> <span class="kn">import</span> <span class="nn">utils</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">colormap_adjust</span>

<span class="n">_base_doc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="s2"></span>
<span class="s2">The underlying pandas.DataFrame is always available with the `data`</span>
<span class="s2">attribute.</span>

<span class="s2">Any attributes not explicitly in this class will be looked for in the</span>
<span class="s2">underlying pandas.DataFrame.</span>

<span class="s2">Parameters</span>
<span class="s2">----------</span>

<span class="s2">data : string or pandas.DataFrame</span>
<span class="s2">    If string, assumes it&#39;s a filename and calls</span>
<span class="s2">    `pandas.read_table(data, **import_kwargs)`.</span>

<span class="s2">db : string or gffutils.FeatureDB</span>
<span class="s2">    Optional database that can be used to generate features</span>

<span class="s2">import_kwargs : dict</span>
<span class="s2">    These arguments will be passed to pandas.read_table() if `data` is</span>
<span class="s2">    a filename.</span>
<span class="s2">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="ResultsTable"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable">[docs]</a><span class="k">class</span> <span class="nc">ResultsTable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base_doc</span> <span class="o">%</span> <span class="n">dedent</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper around a pandas.DataFrame that adds additional functionality.</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">import_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">import_kwargs</span> <span class="o">=</span> <span class="n">import_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">import_kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`data` is not a pandas.DataFrame&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">import_kwargs</span><span class="o">=</span><span class="n">import_kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach_db</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_features</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">attr</span><span class="p">),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="ResultsTable.update"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the current data with a new dataframe.</span>

<span class="sd">        This extra step is required to get around the fancy pandas.DataFrame</span>
<span class="sd">        indexing (like .ix, .iloc, etc).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ResultsTable.copy"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">,</span> <span class="n">import_kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2"> instance, wrapping the following:&quot;</span>
                 <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
        <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<div class="viewcode-block" id="ResultsTable.attach_db"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable.attach_db">[docs]</a>    <span class="k">def</span> <span class="nf">attach_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attach a gffutils.FeatureDB for access to features.</span>

<span class="sd">        Useful if you want to attach a db after this instance has already been</span>
<span class="sd">        created.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        db : gffutils.FeatureDB</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">db</span> <span class="o">=</span> <span class="n">gffutils</span><span class="o">.</span><span class="n">FeatureDB</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">gffutils</span><span class="o">.</span><span class="n">FeatureDB</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`db` must be a filename or a gffutils.FeatureDB&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span></div>

<div class="viewcode-block" id="ResultsTable.features"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable.features">[docs]</a>    <span class="k">def</span> <span class="nf">features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_unknown</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generator of features.</span>

<span class="sd">        If a gffutils.FeatureDB is attached, returns a pybedtools.Interval for</span>
<span class="sd">        every feature in the dataframe&#39;s index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ignore_unknown : bool</span>
<span class="sd">            If True, silently ignores features that are not found in the db.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please attach a gffutils.FeatureDB&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">gffutils</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">asinterval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">except</span> <span class="n">gffutils</span><span class="o">.</span><span class="n">FeatureNotFoundError</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ignore_unknown</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">gffutils</span><span class="o">.</span><span class="n">FeatureNotFoundError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> not found&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="ResultsTable.reindex_to"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable.reindex_to">[docs]</a>    <span class="k">def</span> <span class="nf">reindex_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a copy that only has rows corresponding to feature names in x.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : str or pybedtools.BedTool</span>
<span class="sd">            If str, then assume it&#39;s a filename. BED, GFF, GTF, or VCF where</span>
<span class="sd">            the &quot;Name&quot; field (that is, the value returned by feature[&#39;Name&#39;])</span>
<span class="sd">            or any arbitrary attribute</span>

<span class="sd">        attribute : str or int or None</span>
<span class="sd">            If `x` is GFF or GTF format, and `attribute` is str, then attribute</span>
<span class="sd">            containing the name of the feature to use. If `x` format is BED and</span>
<span class="sd">            `attribute` is str, then use getattr on the interval (e.g., &#39;name&#39;</span>
<span class="sd">            or &#39;score&#39;). If `attribute` is int, then use that column. If None,</span>
<span class="sd">            then use the &quot;name&quot; attribute of the Interval, which falls back to</span>
<span class="sd">            one of &quot;gene_id&quot;, &quot;Name&quot;, &quot;transcript_id&quot; for GFF/GTF.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">attribute</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">x</span><span class="o">.</span><span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;gff&#39;</span> <span class="ow">or</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">):</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attribute</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attribute</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>

        <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new</span></div>

<div class="viewcode-block" id="ResultsTable.align_with"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable.align_with">[docs]</a>    <span class="k">def</span> <span class="nf">align_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align the dataframe&#39;s index with another.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<div class="viewcode-block" id="ResultsTable.scatter"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable.scatter">[docs]</a>    <span class="k">def</span> <span class="nf">scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xfunc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yfunc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">xlab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">genes_to_highlight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">marginal_histograms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">general_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">picker</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">general_hist_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">label_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">one_to_one</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hist_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">hist_pad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">nan_offset</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span> <span class="n">pos_offset</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
                <span class="n">linelength</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">neg_offset</span><span class="o">=</span><span class="mf">0.005</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do-it-all method for making annotated scatterplots.</span>

<span class="sd">        Includes rugplots for NaN/Inf/-Inf, a default callback that prints the</span>
<span class="sd">        entries of the underlying dataframe when a point is clicked, point</span>
<span class="sd">        labeling options, marginal histograms for multiple subsets, arbitrary</span>
<span class="sd">        styling of points for arbitrary subsets, and more.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        x, y : array-like</span>
<span class="sd">            Variables to plot.  Must be names in self.data&#39;s DataFrame.</span>

<span class="sd">        xfunc, yfunc : callable</span>
<span class="sd">            Functions to apply to `xvar` and `yvar` respectively. If xlab or</span>
<span class="sd">            ylab is not set separately, the function name will be used along</span>
<span class="sd">            with the column name to label the corresponding axis. This lets you</span>
<span class="sd">            play around with transformation functions (e.g., np.log, np.log1p)</span>
<span class="sd">            without having to add the corresponding column to the underlying</span>
<span class="sd">            dataframe.</span>

<span class="sd">        xlab, ylab : string</span>
<span class="sd">            Labels for x and y axes; default is to use function names for</span>
<span class="sd">            `xfunc` and `yfunc` and variable names `xvar` and `yvar`, e.g.,</span>
<span class="sd">            &quot;log2(baseMeanA)&quot;</span>

<span class="sd">        ax : None or Axes object</span>
<span class="sd">            If not None then plot on the provided Axes, otherwise create a new</span>
<span class="sd">            figure and axes.</span>

<span class="sd">        general_kwargs : dict</span>
<span class="sd">            Kwargs for matplotlib.scatter; specifies how all points look. Note</span>
<span class="sd">            that if you override this, you should include at least</span>
<span class="sd">            `picker=True` so that the callback function will work.</span>

<span class="sd">        genes_to_highlight : list of 2-tuples or 3-tuples</span>
<span class="sd">            Provides lots of control to colors.  It is a list of (`ind`,</span>
<span class="sd">            `kwargs`) tuples, where each `ind` specifies genes to plot with</span>
<span class="sd">            `kwargs`. `ind` is anything that can be used with `DataFrame.ix`.</span>

<span class="sd">            For example::</span>

<span class="sd">                [</span>
<span class="sd">                    (</span>
<span class="sd">                        x.log2FoldChange &lt; 0,</span>
<span class="sd">                        dict(color=&#39;b&#39;, label=&#39;downregulated&#39;)</span>
<span class="sd">                    ),</span>
<span class="sd">                    (</span>
<span class="sd">                        x.log2FoldChange &gt; 0,</span>
<span class="sd">                        dict(color=&#39;r&#39;, label=&#39;upregulated&#39;)</span>
<span class="sd">                    ),</span>
<span class="sd">                ]</span>

<span class="sd">            Each dictionary updates a copy of `general_kwargs`. If</span>
<span class="sd">            `genes_to_highlight` has a &quot;name&quot; kwarg, this must be a list that&#39;t</span>
<span class="sd">            the same length as `ind`.  It will be used to label the genes in</span>
<span class="sd">            `ind` using `label_kwargs`.</span>

<span class="sd">            For example::</span>

<span class="sd">                [</span>
<span class="sd">                    (</span>
<span class="sd">                        [&#39;ENSG001&#39;, &#39;ENSG002&#39;],</span>
<span class="sd">                        dict(color=&#39;r&#39;, name=[&#39;geneA&#39;, &#39;geneB&#39;])</span>
<span class="sd">                    ),</span>
<span class="sd">                ]</span>

<span class="sd">            The tuples can also be 3-tuples of (ind, scatter_kwargs,</span>
<span class="sd">            hist_kwargs). The first two items act as above, and the third can</span>
<span class="sd">            be used to control histogram kwargs if `marginal_hists` is True.</span>

<span class="sd">            Note that, unless overridden, the color and alpha of the histograms</span>
<span class="sd">            will be inherited from the scatter kwargs, which in turn are</span>
<span class="sd">            inherited from general_kwargs. So the following will modifiy</span>
<span class="sd">            marginal histograms to have 100 bins::</span>

<span class="sd">                [</span>
<span class="sd">                    (</span>
<span class="sd">                        x.log2FoldChange &lt; 0,</span>
<span class="sd">                        dict(color=&#39;b&#39;, label=&#39;down&#39;),</span>
<span class="sd">                        dict(bins=100)</span>
<span class="sd">                    )</span>
<span class="sd">                ]</span>

<span class="sd">        callback : callable</span>
<span class="sd">            Function to call upon clicking a point. Must accept a single</span>
<span class="sd">            argument which is the gene ID. The function can do whatever it</span>
<span class="sd">            wants with it, but probably will want to access the underlying</span>
<span class="sd">            dataframe. Default is to print the corresponding row from the</span>
<span class="sd">            underlying dataframe.</span>

<span class="sd">        one_to_one : None or dict</span>
<span class="sd">            If not None, a dictionary of matplotlib.plot kwargs that will be</span>
<span class="sd">            used to plot a 1:1 line, e.g., dict(color=&#39;r&#39;, linestyle=&#39;:&#39;).</span>

<span class="sd">        label_kwargs : dict</span>
<span class="sd">            Kwargs for labeled genes, e.g., dict=(style=&#39;italic&#39;).  Will only</span>
<span class="sd">            be used if an entry in `genes_to_highlight` has a `name` key.</span>

<span class="sd">        offset_kwargs : dict</span>
<span class="sd">            Kwargs to be passed to matplotlib.transforms.offset_copy, used for</span>
<span class="sd">            adjusting the positioning of gene labels in relation to the actual</span>
<span class="sd">            point.</span>

<span class="sd">        xlab_prefix, ylab_prefix : str</span>
<span class="sd">            Optional label prefix that will be added to the beginning of `xlab`</span>
<span class="sd">            and/or `ylab`.</span>

<span class="sd">        marginal_histograms : bool</span>
<span class="sd">            If True, for each subset in `genes_to_highlight`, add marginal</span>
<span class="sd">            histograms along x and y axes subject to the various histogram</span>
<span class="sd">            controls below.</span>

<span class="sd">        hist_size : float</span>
<span class="sd">            Size of marginal histograms</span>

<span class="sd">        hist_pad : float</span>
<span class="sd">            Spacing between marginal histograms</span>

<span class="sd">        nan_offset, pos_offset, neg_offset : float</span>
<span class="sd">            Offset, in units of &quot;fraction of axes&quot; for the NaN, +inf, and -inf</span>
<span class="sd">            &quot;rug plots&quot;</span>

<span class="sd">        linelength : float</span>
<span class="sd">            Line length for the rug plots</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>

        <span class="c1"># Construct defaults---------------------------------------------------</span>
        <span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Axis label setup</span>
        <span class="k">if</span> <span class="n">xlab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xlab</span> <span class="o">=</span> <span class="n">x</span>

            <span class="k">if</span> <span class="n">xfunc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xfunc</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ylab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ylab</span> <span class="o">=</span> <span class="n">y</span>
            <span class="k">if</span> <span class="n">yfunc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">yfunc</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">xfunc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xfunc</span> <span class="o">=</span> <span class="n">identity</span>

        <span class="k">if</span> <span class="n">yfunc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">yfunc</span> <span class="o">=</span> <span class="n">identity</span>

        <span class="k">if</span> <span class="n">general_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">general_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">general_hist_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">general_hist_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">genes_to_highlight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">genes_to_highlight</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">label_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">label_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span>
                <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Clean data ---------------------------------------------------------</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">xfunc</span><span class="p">(</span><span class="n">_x</span><span class="p">)</span>
        <span class="n">yi</span> <span class="o">=</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">_y</span><span class="p">)</span>

        <span class="c1"># handle inf, -inf, and NaN so we can build the rug plots appropriately</span>
        <span class="n">x_is_pos_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">x_is_neg_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">x_is_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">y_is_pos_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">yi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">y_is_neg_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">yi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">y_is_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>

        <span class="c1"># Indexes for valid values</span>
        <span class="n">x_valid</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">x_is_pos_inf</span> <span class="o">|</span> <span class="n">x_is_neg_inf</span> <span class="o">|</span> <span class="n">x_is_nan</span><span class="p">)</span>
        <span class="n">y_valid</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">y_is_pos_inf</span> <span class="o">|</span> <span class="n">y_is_neg_inf</span> <span class="o">|</span> <span class="n">y_is_nan</span><span class="p">)</span>

        <span class="c1"># global min/max</span>
        <span class="n">gmin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="n">x_valid</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">yi</span><span class="p">[</span><span class="n">y_valid</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
        <span class="n">gmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="n">x_valid</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">yi</span><span class="p">[</span><span class="n">y_valid</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

        <span class="c1"># Now we remove any genes from in allind (which will be plotted using</span>
        <span class="c1"># `general_kwargs`) that will be plotted by something in</span>
        <span class="c1"># genes_to_highlight.  This avoids double-plotting.</span>
        <span class="n">allind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">genes_to_highlight</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">allind</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Copy over the color and alpha from general_kwargs (the scatter</span>
        <span class="c1"># points) to general_hist_kwargs (marginal histograms) if they&#39;re not</span>
        <span class="c1"># otherwise specified</span>
        <span class="n">general_hist_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">updatecopy</span><span class="p">(</span>
            <span class="n">orig</span><span class="o">=</span><span class="n">general_hist_kwargs</span><span class="p">,</span> <span class="n">update_with</span><span class="o">=</span><span class="n">general_kwargs</span><span class="p">,</span>
            <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">])</span>

        <span class="c1"># Put the non-highlighted genes at the beginning of _genes_to_highlight</span>
        <span class="c1"># list so we can just iterate over one list. If genes_to_highlight</span>
        <span class="c1"># styles don&#39;t otherwise override z-order, this means the &quot;background&quot;</span>
        <span class="c1"># gets plotted first and therefore under the highlighted points.</span>
        <span class="n">_genes_to_highlight</span> <span class="o">=</span> <span class="n">genes_to_highlight</span><span class="p">[:]</span>
        <span class="n">_genes_to_highlight</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="n">allind</span><span class="p">,</span> <span class="n">general_kwargs</span><span class="p">,</span> <span class="n">general_hist_kwargs</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Set up the object that will handle the marginal histograms and</span>
        <span class="c1"># plotting.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">marginal</span> <span class="o">=</span> <span class="n">MarginalHistScatter</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span> <span class="n">hist_size</span><span class="o">=</span><span class="n">hist_size</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">hist_pad</span><span class="p">)</span>

        <span class="c1"># Set up kwargs for x and y rug plots</span>
        <span class="n">rug_x_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">linelength</span><span class="o">=</span><span class="n">linelength</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">rug_y_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">linelength</span><span class="o">=</span><span class="n">linelength</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">),</span>
            <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># EventCollection objects need a color as a 3-tuple, so set up</span>
        <span class="c1"># a converter here.</span>
        <span class="n">color_converter</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ColorConverter</span><span class="p">()</span><span class="o">.</span><span class="n">to_rgb</span>

        <span class="c1"># Plot the one-to-one line, if kwargs were specified. If zorder is not</span>
        <span class="c1"># overridden, points will overlay it.</span>
        <span class="k">if</span> <span class="n">one_to_one</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">gmin</span><span class="p">,</span> <span class="n">gmax</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">gmin</span><span class="p">,</span> <span class="n">gmax</span><span class="p">],</span>
                    <span class="o">**</span><span class="n">one_to_one</span><span class="p">)</span>

        <span class="c1"># Plot &#39;em all, and label if specified</span>

        <span class="c1"># In order to avoid calling the callback function multiple times when</span>
        <span class="c1"># we have overlapping genes to highlight (e.g., a gene that is both</span>
        <span class="c1"># upregulated AND has a peak), here we keep track of everything that&#39;s</span>
        <span class="c1"># been added so far.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">_genes_to_highlight</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">hist_kwargs</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hist_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="n">_marginal_histograms</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marginal_histograms&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span>
                <span class="n">marginal_histograms</span><span class="p">)</span>

            <span class="n">updated_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">updatecopy</span><span class="p">(</span>
                <span class="n">orig</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">update_with</span><span class="o">=</span><span class="n">general_kwargs</span><span class="p">)</span>

            <span class="n">updated_hist_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">updatecopy</span><span class="p">(</span>
                <span class="n">orig</span><span class="o">=</span><span class="n">hist_kwargs</span><span class="p">,</span> <span class="n">update_with</span><span class="o">=</span><span class="n">general_hist_kwargs</span><span class="p">)</span>

            <span class="n">updated_hist_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">updatecopy</span><span class="p">(</span>
                <span class="n">orig</span><span class="o">=</span><span class="n">updated_hist_kwargs</span><span class="p">,</span> <span class="n">update_with</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">],</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">xhist_kwargs</span> <span class="o">=</span> <span class="n">updated_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xhist_kwargs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">yhist_kwargs</span> <span class="o">=</span> <span class="n">updated_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;yhist_kwargs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="c1"># MarginalHistScatter does most of the actual plotting work.</span>
            <span class="n">scatter_ind</span> <span class="o">=</span> <span class="n">ind</span> <span class="o">&amp;</span> <span class="n">x_valid</span> <span class="o">&amp;</span> <span class="n">y_valid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marginal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">xi</span><span class="p">[</span><span class="n">scatter_ind</span><span class="p">],</span>
                <span class="n">yi</span><span class="p">[</span><span class="n">scatter_ind</span><span class="p">],</span>
                <span class="n">scatter_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">updated_kwargs</span><span class="p">),</span>
                <span class="n">hist_kwargs</span><span class="o">=</span><span class="n">updated_hist_kwargs</span><span class="p">,</span>
                <span class="n">xhist_kwargs</span><span class="o">=</span><span class="n">xhist_kwargs</span><span class="p">,</span>
                <span class="n">yhist_kwargs</span><span class="o">=</span><span class="n">yhist_kwargs</span><span class="p">,</span>
                <span class="n">marginal_histograms</span><span class="o">=</span><span class="n">_marginal_histograms</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Callback functions have access to the Collection object that was</span>
            <span class="c1"># picked as well as the index into the collection. Since ultimately</span>
            <span class="c1"># we want to access a row of the dataframe, to the collection we</span>
            <span class="c1"># attach the dataframe itself and the index into that dataframe</span>
            <span class="c1"># represented by the scatter points in the collection.</span>
            <span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">marginal</span><span class="o">.</span><span class="n">scatter_ax</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">coll</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">coll</span><span class="o">.</span><span class="n">ind</span> <span class="o">=</span> <span class="n">scatter_ind</span>

            <span class="n">color</span> <span class="o">=</span> <span class="n">color_converter</span><span class="p">(</span><span class="n">updated_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
            <span class="n">rug_x_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
            <span class="n">rug_y_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>

            <span class="c1"># Note: if both x and y are not valid, then they will not be on the</span>
            <span class="c1"># plot at all (since there&#39;s no obvious place to put them).</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span>
                <span class="c1"># top rug, y is +inf and x is valid</span>
                <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">ind</span> <span class="o">&amp;</span> <span class="n">x_valid</span> <span class="o">&amp;</span> <span class="n">y_is_pos_inf</span><span class="p">,</span> <span class="n">pos_offset</span><span class="p">,</span> <span class="n">rug_x_kwargs</span><span class="p">),</span>

                <span class="c1"># one of the bottom rugs, where y is NaN</span>
                <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">ind</span> <span class="o">&amp;</span> <span class="n">x_valid</span> <span class="o">&amp;</span> <span class="n">y_is_nan</span><span class="p">,</span> <span class="n">nan_offset</span><span class="p">,</span> <span class="n">rug_x_kwargs</span><span class="p">),</span>

                <span class="c1"># bottom rug, y is -inf</span>
                <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">ind</span> <span class="o">&amp;</span> <span class="n">x_valid</span> <span class="o">&amp;</span> <span class="n">y_is_neg_inf</span><span class="p">,</span> <span class="n">neg_offset</span><span class="p">,</span> <span class="n">rug_x_kwargs</span><span class="p">),</span>

                <span class="c1"># right rug, x is +inf</span>
                <span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">ind</span> <span class="o">&amp;</span> <span class="n">y_valid</span> <span class="o">&amp;</span> <span class="n">x_is_pos_inf</span><span class="p">,</span> <span class="n">pos_offset</span><span class="p">,</span> <span class="n">rug_y_kwargs</span><span class="p">),</span>

                <span class="c1"># one of the left rugs; x is NaN</span>
                <span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">ind</span> <span class="o">&amp;</span> <span class="n">y_valid</span> <span class="o">&amp;</span> <span class="n">x_is_nan</span><span class="p">,</span> <span class="n">nan_offset</span><span class="p">,</span> <span class="n">rug_y_kwargs</span><span class="p">),</span>

                <span class="c1"># left rug, x is -inf</span>
                <span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">ind</span> <span class="o">&amp;</span> <span class="n">y_valid</span> <span class="o">&amp;</span> <span class="n">x_is_neg_inf</span><span class="p">,</span> <span class="n">neg_offset</span><span class="p">,</span> <span class="n">rug_y_kwargs</span><span class="p">),</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>

                <span class="c1"># provide np.array rather than pandas.Series</span>
                <span class="n">coll</span> <span class="o">=</span> <span class="n">EventCollection</span><span class="p">(</span>
                    <span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lineoffset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">coll</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
                <span class="n">coll</span><span class="o">.</span><span class="n">ind</span> <span class="o">=</span> <span class="n">index</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>

            <span class="c1"># Plot the text names if configured</span>
            <span class="k">if</span> <span class="n">names</span><span class="p">:</span>
                <span class="n">transOffset</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">offset_copy</span><span class="p">(</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">offset_kwargs</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">xii</span><span class="p">,</span> <span class="n">yii</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">yi</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">names</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xii</span><span class="p">,</span>
                            <span class="n">yii</span><span class="p">,</span>
                            <span class="n">name</span><span class="p">,</span>
                            <span class="n">transform</span><span class="o">=</span><span class="n">transOffset</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>

        <span class="c1"># register callback</span>
        <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_callback</span>

        <span class="c1"># This trick is so that we can say, in the docstring, that a callback</span>
        <span class="c1"># function must accept an index name (i.e. gene ID). Much easier than</span>
        <span class="c1"># saying &quot;the callback function accepts an event, and the event&#39;s</span>
        <span class="c1"># artist has an `ind` and `df` attribute&quot;.</span>
        <span class="k">def</span> <span class="nf">wrapped_callback</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id_callback</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
                <span class="n">callback</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>

        <span class="c1"># Connect the callback.</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;pick_event&#39;</span><span class="p">,</span> <span class="n">wrapped_callback</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="ResultsTable.radviz"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.ResultsTable.radviz">[docs]</a>    <span class="k">def</span> <span class="nf">radviz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">transforms</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Radviz plot.</span>

<span class="sd">        Useful for exploratory visualization, a radviz plot can show</span>
<span class="sd">        multivariate data in 2D.  Conceptually, the variables (here, specified</span>
<span class="sd">        in `column_names`) are distributed evenly around the unit circle.  Then</span>
<span class="sd">        each point (here, each row in the dataframe) is attached to each</span>
<span class="sd">        variable by a spring, where the stiffness of the spring is proportional</span>
<span class="sd">        to the value of corresponding variable.  The final position of a point</span>
<span class="sd">        represents the equilibrium position with all springs pulling on it.</span>

<span class="sd">        In practice, each variable is normalized to 0-1 (by subtracting the</span>
<span class="sd">        mean and dividing by the range).</span>

<span class="sd">        This is a very exploratory plot.  The order of `column_names` will</span>
<span class="sd">        affect the results, so it&#39;s best to try a couple different orderings.</span>
<span class="sd">        For other caveats, see [1].</span>

<span class="sd">        Additional kwargs are passed to self.scatter, so subsetting, callbacks,</span>
<span class="sd">        and other configuration can be performed using options for that method</span>
<span class="sd">        (e.g., `genes_to_highlight` is particularly useful).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        column_names : list</span>
<span class="sd">            Which columns of the dataframe to consider.  The columns provided</span>
<span class="sd">            should only include numeric data, and they should not contain any</span>
<span class="sd">            NaN, inf, or -inf values.</span>

<span class="sd">        transforms : dict</span>
<span class="sd">            Dictionary mapping column names to transformations that will be</span>
<span class="sd">            applied just for the radviz plot.  For example, np.log1p is</span>
<span class="sd">            a useful function. If a column name is not in this dictionary, it</span>
<span class="sd">            will be used as-is.</span>

<span class="sd">        ax : matplotlib.Axes</span>
<span class="sd">            If not None, then plot the radviz on this axes.  If None, then</span>
<span class="sd">            a new figure will be created.</span>

<span class="sd">        kwargs : dict</span>
<span class="sd">            Additional arguments are passed to self.scatter.  Note that not all</span>
<span class="sd">            possible kwargs for self.scatter are necessarily useful for</span>
<span class="sd">            a radviz plot (for example, margninal histograms would not be</span>
<span class="sd">            meaningful).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method adds two new variables to self.data: &quot;radviz_x&quot; and</span>
<span class="sd">        &quot;radviz_y&quot;.  It then calls the self.scatter method, using these new</span>
<span class="sd">        variables.</span>

<span class="sd">        The data transformation was adapted from the</span>
<span class="sd">        pandas.tools.plotting.radviz function.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        1. Hoffman,P.E. et al. (1997) DNA visual and analytic data mining. In</span>
<span class="sd">           the Proceedings of the IEEE Visualization. Phoenix, AZ, pp.</span>
<span class="sd">           437-441.</span>
<span class="sd">        2. http://www.agocg.ac.uk/reports/visual/casestud/brunsdon/radviz.htm</span>
<span class="sd">        3. http://pandas.pydata.org/pandas-docs/stable/visualization.html#radviz</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># make a copy of data</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">column_names</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">transforms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
            <span class="n">mn</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
            <span class="n">mx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">series</span> <span class="o">-</span> <span class="n">mn</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">mx</span> <span class="o">-</span> <span class="n">mn</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">normalize</span><span class="p">)</span>

        <span class="n">to_plot</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
                      <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]])</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">irow</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">row_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">to_plot</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span> <span class="o">*</span> <span class="n">row_</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">row</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

        <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">to_plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;radviz_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;radviz_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s1">&#39;radviz_x&#39;</span><span class="p">,</span> <span class="s1">&#39;radviz_y&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">xy</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">column_names</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div>

    <span class="k">def</span> <span class="nf">_id_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># event.ind is the index into event&#39;s x and y data.</span>
        <span class="c1">#</span>
        <span class="c1"># event.artist.ind is the index of the entire artist into the original</span>
        <span class="c1"># dataframe.</span>
        <span class="n">subset_df</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">artist</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">artist</span><span class="o">.</span><span class="n">ind</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">ind</span><span class="p">:</span>
            <span class="n">_id</span> <span class="o">=</span> <span class="n">subset_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">yield</span> <span class="n">_id</span>

    <span class="k">def</span> <span class="nf">_default_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div>


<div class="viewcode-block" id="DifferentialExpressionResults"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DifferentialExpressionResults">[docs]</a><span class="k">class</span> <span class="nc">DifferentialExpressionResults</span><span class="p">(</span><span class="n">ResultsTable</span><span class="p">):</span>

    <span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base_doc</span> <span class="o">%</span> <span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    A ResultsTable subclass for working with differential expression results.</span>

<span class="s2">    Adds methods for up/down regulation, ma_plot, and sets class variables for</span>
<span class="s2">    which columns should be considered for pval, log fold change, and mean</span>
<span class="s2">    values. This class acts as a parent for subclasses like DESeqResults,</span>
<span class="s2">    EdgeRResults, and others/</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="n">pval_column</span> <span class="o">=</span> <span class="s1">&#39;padj&#39;</span>
    <span class="n">lfc_column</span> <span class="o">=</span> <span class="s1">&#39;log2FoldChange&#39;</span>
    <span class="n">mean_column</span> <span class="o">=</span> <span class="s1">&#39;baseMean&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">header_check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">import_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;import_kwargs&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">header_check</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">comment_char</span> <span class="o">=</span> <span class="n">import_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">)</span>
            <span class="n">import_kwargs</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comment_char</span>
        <span class="n">import_kwargs</span><span class="p">[</span><span class="s1">&#39;na_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nan&#39;</span><span class="p">]</span>
        <span class="n">import_kwargs</span><span class="p">[</span><span class="s1">&#39;index_col&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">import_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;index_col&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DifferentialExpressionResults</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">import_kwargs</span><span class="o">=</span><span class="n">import_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="DifferentialExpressionResults.changed"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DifferentialExpressionResults.changed">[docs]</a>    <span class="k">def</span> <span class="nf">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lfc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changed features.</span>

<span class="sd">        Helper function to get where the pval is &lt;= alpha and the</span>
<span class="sd">        absolute value log2foldchange is &gt;= lfc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        alpha : float</span>

<span class="sd">        lfc : float</span>

<span class="sd">        idx : bool</span>
<span class="sd">            If True, a boolean index will be returned.  If False, a new object</span>
<span class="sd">            will be returned that has been subsetted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pval_column</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lfc_column</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">lfc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ind</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span></div>

<div class="viewcode-block" id="DifferentialExpressionResults.unchanged"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DifferentialExpressionResults.unchanged">[docs]</a>    <span class="k">def</span> <span class="nf">unchanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lfc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unchanged features.</span>

<span class="sd">        Helper function to get where the pval is &gt; alpha and the</span>
<span class="sd">        absolute value of the log2foldchange is &lt; lfc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        alpha : float</span>

<span class="sd">        lfc : float</span>

<span class="sd">        idx : bool</span>
<span class="sd">            If True, a boolean index will be returned.  If False, a new object</span>
<span class="sd">            will be returned that has been subsetted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">lfc</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ind</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span></div>

<div class="viewcode-block" id="DifferentialExpressionResults.upregulated"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DifferentialExpressionResults.upregulated">[docs]</a>    <span class="k">def</span> <span class="nf">upregulated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lfc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upregulated features.</span>

<span class="sd">        Helper function to get where the pval is &lt;= alpha and the</span>
<span class="sd">        log2foldchange is &gt;= lfc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        alpha : float</span>

<span class="sd">        lfc : float</span>

<span class="sd">        idx : bool</span>
<span class="sd">            If True, a boolean index will be returned.  If False, a new object</span>
<span class="sd">            will be returned that has been subsetted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pval_column</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lfc_column</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lfc</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ind</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span></div>

<div class="viewcode-block" id="DifferentialExpressionResults.downregulated"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DifferentialExpressionResults.downregulated">[docs]</a>    <span class="k">def</span> <span class="nf">downregulated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lfc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downregulated features.</span>

<span class="sd">        Helper function to get where the pval is &lt;= alpha and the</span>
<span class="sd">        log2foldchange is &lt;= lfc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        alpha : float</span>

<span class="sd">        lfc : float</span>

<span class="sd">        idx : bool</span>
<span class="sd">            If True, a boolean index will be returned.  If False, a new object</span>
<span class="sd">            will be returned that has been subsetted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pval_column</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lfc_column</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">lfc</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ind</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span></div>

<div class="viewcode-block" id="DifferentialExpressionResults.ma_plot"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DifferentialExpressionResults.ma_plot">[docs]</a>    <span class="k">def</span> <span class="nf">ma_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">up_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dn_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">zero_line</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        MA plot.</span>

<span class="sd">        Plots the average read count across treatments (x-axis) vs the log2</span>
<span class="sd">        fold change (y-axis).</span>

<span class="sd">        Additional kwargs are passed to self.scatter (useful ones might include</span>
<span class="sd">        `genes_to_highlight`)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        alpha : float</span>
<span class="sd">            Features with values &lt;= `alpha` will be highlighted in the plot.</span>

<span class="sd">        up_kwargs, dn_kwargs : None or dict</span>
<span class="sd">            Kwargs passed to matplotlib&#39;s scatter(), used for styling up/down</span>
<span class="sd">            regulated features (defined by `alpha` and `col`)</span>

<span class="sd">        zero_line : None or dict</span>
<span class="sd">            Kwargs passed to matplotlib.axhline(0).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">genes_to_highlight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;genes_to_highlight&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">genes_to_highlight</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upregulated</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span>
             <span class="n">up_kwargs</span> <span class="ow">or</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)))</span>
        <span class="n">genes_to_highlight</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">downregulated</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span>
             <span class="n">dn_kwargs</span> <span class="ow">or</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">zero_line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">zero_line</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_column</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lfc_column</span>

        <span class="k">if</span> <span class="s1">&#39;xfunc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xfunc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
            <span class="n">genes_to_highlight</span><span class="o">=</span><span class="n">genes_to_highlight</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zero_line</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">zero_line</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div></div>


<div class="viewcode-block" id="EdgeRResults"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.EdgeRResults">[docs]</a><span class="k">class</span> <span class="nc">EdgeRResults</span><span class="p">(</span><span class="n">DifferentialExpressionResults</span><span class="p">):</span>
    <span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base_doc</span> <span class="o">%</span> <span class="n">dedent</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class for working with results from edgeR.</span>

<span class="sd">        Just like a DifferentialExpressionResults object, but sets the</span>
<span class="sd">        pval_column, lfc_column, and mean_column to the names used in edgeR&#39;s</span>
<span class="sd">        output.</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="n">pval_column</span> <span class="o">=</span> <span class="s1">&#39;FDR&#39;</span>
    <span class="n">lfc_column</span> <span class="o">=</span> <span class="s1">&#39;logFC&#39;</span>
    <span class="n">mean_column</span> <span class="o">=</span> <span class="s1">&#39;logCPM&#39;</span></div>


<div class="viewcode-block" id="DESeqResults"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DESeqResults">[docs]</a><span class="k">class</span> <span class="nc">DESeqResults</span><span class="p">(</span><span class="n">DifferentialExpressionResults</span><span class="p">):</span>
    <span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base_doc</span> <span class="o">%</span> <span class="n">dedent</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class for working with results from DESeq.</span>

<span class="sd">        Just like a DifferentialExpressionResults object, but sets the</span>
<span class="sd">        pval_column, lfc_column, and mean_column to the names used in DESeq</span>
<span class="sd">        (v1) output.</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="DESeqResults.colormapped_bedfile"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DESeqResults.colormapped_bedfile">[docs]</a>    <span class="k">def</span> <span class="nf">colormapped_bedfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genome</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a BED file with padj encoded as color</span>

<span class="sd">        Features will be colored according to adjusted pval (phred</span>
<span class="sd">        transformed).  Downregulated features have the sign flipped.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cmap : matplotlib colormap</span>
<span class="sd">            Default is matplotlib.cm.RdBu_r</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Requires a FeatureDB to be attached.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;FeatureDB required&quot;</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">gffutils</span><span class="o">.</span><span class="n">FeatureDB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">scored_feature_generator</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">feature</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">except</span> <span class="n">gffutils</span><span class="o">.</span><span class="n">FeatureNotFoundError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">gffutils</span><span class="o">.</span><span class="n">FeatureNotFoundError</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">score</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">padj</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">lfc</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">log2FoldChange</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">lfc</span><span class="p">):</span>
                    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">lfc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">score</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">feature</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
                <span class="n">feature</span> <span class="o">=</span> <span class="n">featurefuncs</span><span class="o">.</span><span class="n">extend_fields</span><span class="p">(</span>
                    <span class="n">featurefuncs</span><span class="o">.</span><span class="n">gff2bed</span><span class="p">(</span>
                        <span class="n">gffutils</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">asinterval</span><span class="p">(</span><span class="n">feature</span><span class="p">)),</span> <span class="mi">9</span><span class="p">)</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">fields</span><span class="p">[:]</span>
                <span class="n">fields</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">fields</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">padj</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pval</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">d</span><span class="o">.</span><span class="n">log2FoldChange</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">d</span><span class="o">.</span><span class="n">baseMeanB</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">d</span><span class="o">.</span><span class="n">baseMeanB</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">yield</span> <span class="n">pybedtools</span><span class="o">.</span><span class="n">create_interval_from_list</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">pybedtools</span><span class="o">.</span><span class="n">BedTool</span><span class="p">(</span><span class="n">scored_feature_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">saveas</span><span class="p">()</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">colormap_normalize</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormap_adjust</span><span class="o">.</span><span class="n">cmap_center_point_adjust</span><span class="p">(</span>
            <span class="n">cmap</span><span class="p">,</span> <span class="p">[</span><span class="n">norm</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">vmax</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">score_zeroer</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
            <span class="k">return</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">each</span><span class="p">(</span><span class="n">featurefuncs</span><span class="o">.</span><span class="n">add_color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">sort</span><span class="p">()</span>\
                <span class="o">.</span><span class="n">each</span><span class="p">(</span><span class="n">score_zeroer</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">truncate_to_chrom</span><span class="p">(</span><span class="n">genome</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">saveas</span><span class="p">()</span></div>

<div class="viewcode-block" id="DESeqResults.autosql_file"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DESeqResults.autosql_file">[docs]</a>    <span class="k">def</span> <span class="nf">autosql_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate the autosql for DESeq results (to create bigBed)</span>

<span class="sd">        Returns a temp filename containing the autosql defining the extra</span>
<span class="sd">        fields.</span>

<span class="sd">        This for creating bigBed files from BED files created by</span>
<span class="sd">        colormapped_bed.  When a user clicks on a feature, the DESeq results</span>
<span class="sd">        will be reported.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">pybedtools</span><span class="o">.</span><span class="n">BedTool</span><span class="o">.</span><span class="n">_tmp</span><span class="p">()</span>

        <span class="n">AUTOSQL</span> <span class="o">=</span> <span class="n">dedent</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            table example</span>
<span class="sd">            &quot;output from DESeq&quot;</span>
<span class="sd">            (</span>
<span class="sd">            string  chrom;  &quot;chromosome&quot;</span>
<span class="sd">            uint chromStart; &quot;start coord&quot;</span>
<span class="sd">            uint chromEnd; &quot;stop coord&quot;</span>
<span class="sd">            string name; &quot;name of feature&quot;</span>
<span class="sd">            uint score; &quot;always zero&quot;</span>
<span class="sd">            char[1] strand; &quot;+ or - for strand&quot;</span>
<span class="sd">            uint    thickStart; &quot;Coding region start&quot;</span>
<span class="sd">            uint    thickEnd;  &quot;Coding region end&quot;</span>
<span class="sd">            uint reserved; &quot;color according to score&quot;</span>
<span class="sd">            string padj; &quot;DESeq adjusted p value&quot;</span>
<span class="sd">            string pval; &quot;DESeq raw p value&quot;</span>
<span class="sd">            string logfoldchange; &quot;DESeq log2 fold change&quot;</span>
<span class="sd">            string basemeana; &quot;DESeq baseMeanA&quot;</span>
<span class="sd">            string basemeanb; &quot;DESeq baseMeanB&quot;</span>
<span class="sd">        )</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">fout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">AUTOSQL</span><span class="p">)</span>
        <span class="n">fout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fn</span></div></div>


<div class="viewcode-block" id="DESeq2Results"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.DESeq2Results">[docs]</a><span class="k">class</span> <span class="nc">DESeq2Results</span><span class="p">(</span><span class="n">DESeqResults</span><span class="p">):</span>
    <span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base_doc</span> <span class="o">%</span> <span class="n">dedent</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class for working with results from DESeq2.</span>

<span class="sd">        Just like a DifferentialExpressionResults object, but sets the</span>
<span class="sd">        pval_column, lfc_column, and mean_column to the names used in edgeR&#39;s</span>
<span class="sd">        output.</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="n">pval_column</span> <span class="o">=</span> <span class="s1">&#39;padj&#39;</span>
    <span class="n">lfc_column</span> <span class="o">=</span> <span class="s1">&#39;log2FoldChange&#39;</span>
    <span class="n">mean_column</span> <span class="o">=</span> <span class="s1">&#39;baseMean&#39;</span></div>


<div class="viewcode-block" id="LazyDict"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.LazyDict">[docs]</a><span class="k">class</span> <span class="nc">LazyDict</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn_dict</span><span class="p">,</span> <span class="n">index_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index_from</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="bp">cls</span><span class="o">=</span><span class="n">DESeqResults</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary-like object that lazily-loads ResultsTable objects.</span>

<span class="sd">        Primary use-case for this is for organizing a large number of</span>
<span class="sd">        differential expression results that you&#39;ll be cross-comparing and 1)</span>
<span class="sd">        you don&#39;t want to immediately load EVERYTHING into a dataframe, and 2)</span>
<span class="sd">        you want to ensure the indexes are aligned across dataframes.</span>

<span class="sd">        Only upon accessing a value from the LazyDict will the data be loaded</span>
<span class="sd">        into a DataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fn_dict : dict</span>
<span class="sd">            Keys of `fn_dict` will be the keys of this LazyDict object.  Values</span>
<span class="sd">            should be filenames which will be loaded into ResultsTable object</span>
<span class="sd">            upon access for the first time.</span>

<span class="sd">        index_file : str</span>
<span class="sd">            Path to a file that contains one ID per line.  This file is used to</span>
<span class="sd">            ensure all ResultsTable objects are aligned to the same index. If</span>
<span class="sd">            you don&#39;t want to provide this, then set it to None and consider</span>
<span class="sd">            the `index_from` kwarg.</span>

<span class="sd">        index_from : str</span>
<span class="sd">            Key of the dataframe whose index will be used to align other</span>
<span class="sd">            dataframes. If this is provided, this dataframe will have to be</span>
<span class="sd">            loaded before any others, so the first access will trigger two</span>
<span class="sd">            dataframe loads.</span>

<span class="sd">        cls : ResultsTable class or subclass</span>
<span class="sd">            Each filename in `fn_dict` will be converted using this class.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fn_dict</span> <span class="o">=</span> <span class="n">fn_dict</span>

        <span class="c1"># this acts as the cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">index_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">index_from</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Only one of `index_file` or `index_from` should be provided.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_file</span> <span class="o">=</span> <span class="n">index_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_from</span> <span class="o">=</span> <span class="n">index_from</span>

        <span class="k">if</span> <span class="n">index_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">index_file</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cls</span> <span class="o">=</span> <span class="bp">cls</span>

    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cls</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fn_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_from</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_from</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span>

        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; with possible keys</span><span class="se">\n</span><span class="s2">:</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> \
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;and existing keys:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>

<div class="viewcode-block" id="LazyDict.keys"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.LazyDict.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="LazyDict.values"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.LazyDict.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span></div>

<div class="viewcode-block" id="LazyDict.items"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.LazyDict.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="MarginalHistScatter"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.MarginalHistScatter">[docs]</a><span class="k">class</span> <span class="nc">MarginalHistScatter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">hist_size</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class to enable incremental appending of scatterplots, each of which</span>
<span class="sd">        generate additional marginal histograms.</span>

<span class="sd">        The `append` method does most of the work.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">top_hists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_hists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hist_size</span> <span class="o">=</span> <span class="n">hist_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xfirst_ax</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yfirst_ax</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># will hold histogram data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hxs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hys</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span><span class="o">.</span><span class="n">dataLim</span><span class="o">.</span><span class="n">xmax</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ymax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span><span class="o">.</span><span class="n">dataLim</span><span class="o">.</span><span class="n">ymax</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xmin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span><span class="o">.</span><span class="n">dataLim</span><span class="o">.</span><span class="n">xmin</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ymin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span><span class="o">.</span><span class="n">dataLim</span><span class="o">.</span><span class="n">ymin</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>

<div class="viewcode-block" id="MarginalHistScatter.append"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.MarginalHistScatter.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scatter_kwargs</span><span class="p">,</span> <span class="n">hist_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xhist_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">yhist_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_ticks</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hist_share</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">marginal_histograms</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a new scatter to self.scatter_ax as well as marginal histograms</span>
<span class="sd">        for the same data, borrowing addtional room from the axes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        x, y : array-like</span>
<span class="sd">            Data to be plotted</span>

<span class="sd">        scatter_kwargs : dict</span>
<span class="sd">            Keyword arguments that are passed directly to scatter().</span>

<span class="sd">        hist_kwargs : dict</span>
<span class="sd">            Keyword arguments that are passed directly to hist(), for both the</span>
<span class="sd">            top and side histograms.</span>

<span class="sd">        xhist_kwargs, yhist_kwargs : dict</span>
<span class="sd">            Additional, margin-specific kwargs for the x or y histograms</span>
<span class="sd">            respectively.  These are used to update `hist_kwargs`</span>

<span class="sd">        num_ticks : int</span>
<span class="sd">            How many tick marks to use in each histogram&#39;s y-axis</span>

<span class="sd">        labels : array-like</span>
<span class="sd">            Optional NumPy array of labels that will be set on the collection</span>
<span class="sd">            so that they can be accessed by a callback function.</span>

<span class="sd">        hist_share : bool</span>
<span class="sd">            If True, then all histograms will share the same frequency axes.</span>
<span class="sd">            Useful for showing relative heights if you don&#39;t want to use the</span>
<span class="sd">            hist_kwarg `normed=True`</span>

<span class="sd">        marginal_histograms : bool</span>
<span class="sd">            Set to False in order to disable marginal histograms and just use</span>
<span class="sd">            as a normal scatterplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scatter_kwargs</span> <span class="o">=</span> <span class="n">scatter_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">hist_kwargs</span> <span class="o">=</span> <span class="n">hist_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">xhist_kwargs</span> <span class="o">=</span> <span class="n">xhist_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">yhist_kwargs</span> <span class="o">=</span> <span class="n">yhist_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">yhist_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">))</span>

        <span class="c1"># Plot the scatter</span>
        <span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">scatter_kwargs</span><span class="p">)</span>
        <span class="n">coll</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">marginal_histograms</span><span class="p">:</span>
            <span class="c1"># that was easy!</span>
            <span class="k">return</span>

        <span class="n">xhk</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">updatecopy</span><span class="p">(</span><span class="n">hist_kwargs</span><span class="p">,</span> <span class="n">xhist_kwargs</span><span class="p">)</span>
        <span class="n">yhk</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">updatecopy</span><span class="p">(</span><span class="n">hist_kwargs</span><span class="p">,</span> <span class="n">yhist_kwargs</span><span class="p">)</span>

        <span class="n">axhistx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span>
            <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hist_size</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xfirst_ax</span><span class="p">)</span>

        <span class="n">axhisty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span>
            <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hist_size</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scatter_ax</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yfirst_ax</span><span class="p">)</span>

        <span class="n">axhistx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span>
            <span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="n">num_ticks</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">))</span>

        <span class="n">axhisty</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span>
            <span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="n">num_ticks</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">xfirst_ax</span> <span class="ow">and</span> <span class="n">hist_share</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xfirst_ax</span> <span class="o">=</span> <span class="n">axhistx</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">yfirst_ax</span> <span class="ow">and</span> <span class="n">hist_share</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yfirst_ax</span> <span class="o">=</span> <span class="n">axhisty</span>

        <span class="c1"># Keep track of which axes are which, because looking into fig.axes</span>
        <span class="c1"># list will get awkward....</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_hists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axhistx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_hists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axhisty</span><span class="p">)</span>

        <span class="c1"># Scatter will deal with NaN, but hist will not.  So clean the data</span>
        <span class="c1"># here.</span>
        <span class="n">hx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="n">hy</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hy</span><span class="p">)</span>

        <span class="c1"># Only plot hists if there&#39;s valid data</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">_xhk</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">updatecopy</span><span class="p">(</span>
                    <span class="n">orig</span><span class="o">=</span><span class="n">xhk</span><span class="p">,</span> <span class="n">update_with</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">hx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span>
                    <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">])</span>
                <span class="n">axhistx</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hx</span><span class="p">,</span> <span class="o">**</span><span class="n">_xhk</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axhistx</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hx</span><span class="p">,</span> <span class="o">**</span><span class="n">xhk</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">_yhk</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">updatecopy</span><span class="p">(</span>
                    <span class="n">orig</span><span class="o">=</span><span class="n">yhk</span><span class="p">,</span> <span class="n">update_with</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">hy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hy</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span>
                    <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">])</span>
                <span class="n">axhisty</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hy</span><span class="p">,</span> <span class="o">**</span><span class="n">_yhk</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axhisty</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hy</span><span class="p">,</span> <span class="o">**</span><span class="n">yhk</span><span class="p">)</span>

        <span class="c1"># Turn off unnecessary labels -- for these, use the scatter&#39;s axes</span>
        <span class="c1"># labels</span>
        <span class="k">for</span> <span class="n">txt</span> <span class="ow">in</span> <span class="n">axhisty</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">axhistx</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span>
            <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">txt</span> <span class="ow">in</span> <span class="n">axhisty</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span>
            <span class="n">txt</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span></div>

<div class="viewcode-block" id="MarginalHistScatter.add_legends"><a class="viewcode-back" href="../../../autodocs/lcdblib.plotting.html#lcdblib.plotting.results_table.MarginalHistScatter.add_legends">[docs]</a>    <span class="k">def</span> <span class="nf">add_legends</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xhists</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yhists</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add legends to axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">xhists</span><span class="p">:</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hxs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yhists</span><span class="p">:</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hys</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scatter</span><span class="p">:</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
</pre></div>

          </div>
            
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">lcdblib 0.1.2.post.dev37 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../../../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2016, lcdb. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>